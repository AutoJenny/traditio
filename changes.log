2025-05-12: Added product document upload and management to admin product Source tab. Implemented API endpoints for upload, listing, and deletion of ProductDocuments. Updated UI to support document upload, display, and removal. 

[2024-05-13] Added GET handler to src/app/api/products/[slug]/route.ts to resolve 405 error and allow fetching product details by slug. 

[2024-05-13] Fixed admin product edit page: updated GET handler in src/app/api/products/[slug]/route.ts to wrap product in a 'product' property in the response. 

[2024-05-13] Improved PUT handler in src/app/api/products/[slug]/route.ts: added error handling/logging and optimized update logic to only update categories/images if provided, avoiding unnecessary deleteMany/create operations. 

[2024-05-13] Fixed bug in PUT handler for products: sanitized categoryIds to filter out null/invalid values before updating categories, preventing Prisma errors and failed updates. 

[2024-05-13] Fixed Next.js dynamic API route param usage and optimized PUT handler to only update categories/images if changed, improving admin save performance. 

[2024-05-13] Added CORS headers and OPTIONS handler to categories and product API routes for cross-origin compatibility. 

[2024-05-13] Fixed dynamic API route handler signatures in products/[slug] to use correct Next.js convention, removing unnecessary await/context destructuring. 

[2024-05-13] Fixed admin product edit: sanitize payload before PUT, only sending valid fields (categoryIds, images, etc.) to backend for updates. 

[2024-05-13] Fixed category update in product PUT handler: now uses explicit deleteMany/createMany for ProductCategory join table, ensuring updates persist for many-to-many relations. 

[2024-05-13] Fixed showroom category filtering: updated filter logic in src/app/showroom/page.tsx to use cat.category.slug instead of cat.slug, matching the API response structure. 

[2024-05-13] Restored DnD image management UI to src/app/admin/products/[slug]/images/page.tsx from backup. The page now supports drag-and-drop reordering, alt text editing, image upload, and save functionality. 

[2024-05-13 15:00] Created scripts/seed_db.ts to clear and repopulate Category, Product, Image, and ProductCategory tables using categories.json, products.json, images.jsonl, and product_categories.json. Uses pg and lib/db.ts. This replaces all previous Prisma-based seeding. 

[2024-05-18  DELETE handler for product soft-delete] Added DELETE handler to src/app/api/products/[slug]/route.ts to support soft-deleting products by setting status to 'deleted'. 

[2024-05-18  await context.params fix] Updated all handlers in src/app/api/products/[slug]/route.ts to use 'const { params } = await context;' and 'const slug = params.slug;' as required by Next.js 15+ dynamic API routes. 

[2025-05-13 admin delete refactor] Refactored admin product edit page: delete button is now a prominent trash icon outside the form, ensuring it always sends DELETE and never triggers a PUT. 

[YYYY-MM-DD] Admin UI: Edit button is now a blue button, Delete is a trash icon button that sends a DELETE request to the API (not a PUT). Ensured delete is distinct and works as expected. UI and API behavior now match requirements. 

[YYYY-MM-DD] Admin product list: Edit button is now a small blue circle with a pen icon instead of text. 

[YYYY-MM-DD] Show Deleted checkbox now works: API supports ?showDeleted=1 to include deleted products; frontend refetches accordingly. 

[YYYY-MM-DD] Commented out Sign In and basket icon links in the header (layout.tsx), not deleted. 

[YYYY-MM-DD] Contact API now stores customers and messages in the new tables, linking messages to customers, and uses the correct schema fields. 

[YYYY-MM-DD] Updated /api/enquiry API to store pageUrl in the Message table, so product enquiries now include the page source with the message, matching the contact form. 

[YYYY-MM-DD] Product detail page: 'Enquire about this item' button now reveals and scrolls to the enquiry form below, instead of doing nothing. Improves UX and makes the form discoverable. 

[YYYY-MM-DD] Fix: Enquiry API now matches actual Message table schema (uses 'message', adds ipAddress/userAgent, removes productSlug). Resolves form submission error. 

[2024-05-13] Hardened product image update flow: backend now rejects updates that would remove all images, and frontend warns/prevents saving if no images are present. Both changes prevent accidental image loss. 

[2024-05-13] Improved admin product image upload: after uploading an image, the page now auto-saves the image order/state to the backend, making the flow foolproof and preventing accidental image loss or state mismatch. 